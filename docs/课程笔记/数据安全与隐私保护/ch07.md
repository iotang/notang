# 第 7 章：流加密和 CPA 安全

## 流加密

### 伪随机数生成器

流加密得使用一个伪随机数生成器（Pseudo Random (Number) Generator，PR(N)G）：$G: \{0, 1\}^s \to \{0, 1\}^n$，即把一个随机数种子拓展到很大一坨“看起来是”随机的 01 序列。

### 分辨者

一个对于两个分布的分辨者（Distinguisher），需要（可以）对给定的序列判断它是从哪个分布生成的。

### 伪随机生成

如果某个算法 $G$ 有长度为 n 的输入和长度为 $l(n)$ 的输出，并且：

- 对于所有 n，$l(n) > n$；
- 并且对于所有 PPT 分辨者，存在一个可忽略函数 $negl(n)$，满足：$|\Pr[D(r) = 1] - \Pr[D(G(s)) = 1]| \leq negl(n)$，其中 r 是在 $\{0, 1\}^{l(n)}$ 中的真随机，s 是 $\{0, 1\}^{n}$ 中的真随机；

那么这个 G 就可以被叫做伪随机数生成器。

### PRG 的安全

如果系统 $\Pi$ 是使用一个 PRG 拿 $G(k) \oplus m$ 方法加密的，那么即使有窃听者，它的加密也是不可区分的。

如果加密是可区分的，我们就可以用分辨者破解这个系统。

### 变长的输出

如果对于长度 l，某个 PRG 满足：

- 某个短输出总是长输出的前缀；
- 即使把输出截短也满足 PRG；

那么这个变长输出 PRG 就是 $G(s, 1^l)$ 的。
