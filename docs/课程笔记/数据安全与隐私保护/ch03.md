# 第 3 章：MAC 和完整性保护

## 多层安全 Multi-Level Security

用户、角色和主体有自己的安全许可证（security clearances），客体有安全等级（security classifications）。一种安全等级的划分如下：

- Top Secret
- Secret
- Confidential
- Unclassified

用户、主体和客体都拥有自己的等级。高等级的客体不会被低等级的东西碰到。

## 强制访问控制 Mandatory Access Control

### 安全模型

- 系统模型
- 安全政策：对于某个系统的安全需求

系统模型 + 安全政策 = 安全模型

### 机密性模型：BLP 模型（上读下写政策）

- 一般情况：S 可以读 O 当且仅当 L_m(S) >= L(O)。
- 对于一个没有被信任的 S，
  - S 可以读 O 当且仅当 L_c(S) >= L(O)；
  - S 可以写 O 当且仅当 L_c(S) <= L(O)，也就是高不能往低写，因为这样的话高机密性的人写出来的高机密性的东西就会流到低机密性的地方，这不能确保机密性。

### 完整性模型：Biba 模型

相对于机密性，我们有时候需要关注数据的完整性。数据完整性（数据可靠性）的意思是数据不能有未被监测的修改。

- Tier 1：不能被修改。
- Tier 2：只能通过一点点接口进行修改，比如 sudoers 文件。
- Tier 3：可以被一些有权限的程序修改。
- Tier 4：可以被已经登录的用户修改。

感觉就是 BLP 模型反过来……

- S 可以读 O 当且仅当 L_c(S) <= L(O)，阻止受污染数据的间接破坏；
- S 可以写 O 当且仅当 L_c(S) >= L(O)。

### 低水位三政策

主体低水位政策（Subject Low-Water Mark Policy）修改用户的权限。

- 如果某个 S 读了个 O，那么之后 i(S) = min(i(S), i(O))。
- S 可以写 O 当且仅当 i(S) >= i(O)。

客体低水位标记政策（Object Low-Water Mark Policy）修改文件的权限。

- S 可以读 O 当且仅当 i(S) <= i(O)。
- 如果某个 S 写了 O，那么 i(O) = min(i(O), i(S))。

低水位标记完整性审计政策（Low-Water Mark Integrity Audit Policy）是上面两者的合并。

- 如果某个 S 读了个 O，那么 i(S) = min(i(S), i(O))。
- 如果某个 S 写了 O，那么 i(O) = min(i(O), i(S))。

### 环政策

- 所有文件都可读。
- S 可以读 O 当且仅当 i(S) >= i(O)。
